extends ../layout.jade
block content
  .container
    .row
      .page-header
        h1 Show

        - if (success_messages.length != 0)
          p.bg-success= success_messages

        code
          pre= gambit

    - if (error_messages.length != 0)
      p.bg-warning= error_messages

    form.form-horizontal(action="/gambits/#{gambit._id}", method="post")
      input(type="hidden", name="_method", value="put")
      .form-group
        label.col-sm-2.control-label(for='formName') Input
        .col-sm-10
          input#formName.form-control.input-lg(type='text', name="input", placeholder='Input', value='#{gambit.input}')
      .form-group
        .col-sm-offset-2.col-sm-10
          .checkbox
            label
              if gambit.isQuestion
                input#js-isQuestion(type='checkbox', name="isQuestion", checked="true") 
                | Match Questions
              else 
                input#js-isQuestion(type='checkbox', name="isQuestion") 
                | Match Questions

      .form-group.js-questionType
        label.col-sm-2.control-label(for='reply') Question Type
        .col-xs-3
          select#qtype.form-control(name="qType")
            option(value="") None
            option(value="WH") Question word
            option(value="YN") Yes/No
            option(value="TG") Tag Question
            option(value="CH") Choice Question

      #replyGroup
        - for (var i = 0; i < gambit.replies.length; i++)
          .form-group
            if i === 0
              label.col-sm-2.control-label(for='reply') Replies
            .col-sm-6
              input#replys.form-control(type='text', name="reply", placeholder='Reply', value="#{gambit.replies[i].reply}")
            .col-sm-4
              a.js-replySubmit.btn.btn-success
                span.glyphicon.glyphicon-ok(aria-hidden='true') 

      .form-group
        .col-sm-offset-2.col-sm-10
          button.btn.btn-default(type='submit') Update Gambit

      script.
      
        $(".js-replySubmit").click(function(e){
          console.log("Submit Reply");

          user_data = {
            name: "Henrik Joreteg",
            twitter: "HenrikJoreteg",
            employer: "&yet",
            job_title: "JS nerd"
          };

          // Here's all the magic.
          console.log("----", ich)
          var user = ich.reply(user_data);

          // append it to the list, tada!
          //Now go do something more useful with this.
          $('#replyGroup').append(user);


          $.ajax({ 
            url: '/gambits/#{gambit._id}/reply', 
            type: 'POST',
            success: function(result) {
              $(e.target).parents('tr').remove();
              //- swal("Deleted!", "Gone", "success"); 
            }
          });

        });

        if (!$('input#js-isQuestion').is(':checked')) {
          $('.js-questionType').addClass('hidden');
        }

        $("#js-isQuestion").click(function(e){
          $('.js-questionType').toggleClass('hidden');
        })

      script(id="reply" type="text/html").
        <div class="form-group">
          <div class="col-sm-6 col-sm-offset-2">
            <input class="form-control" placeholder="Reply">
          </div>
          <div class="col-sm-4">
            <a href="#" class="js-replySubmit btn btn-success">
              <span class="glyphicon glyphicon-ok" aria-hidden='true'>
            </a>
          </div>
        </div>


